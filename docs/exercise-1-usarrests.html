<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Exercise 1: USArrests | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="2 Exercise 1: USArrests | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Exercise 1: USArrests | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Exercise 1: USArrests | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 9</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#k-means"><i class="fa fa-check"></i><b>1.1</b> K-means</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#k-medoids"><i class="fa fa-check"></i><b>1.2</b> K-medoids</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exercise-1-usarrests.html"><a href="exercise-1-usarrests.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: USArrests</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-1-usarrests" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Exercise 1: USArrests<a href="exercise-1-usarrests.html#exercise-1-usarrests" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this exercise, we will continue studying the <code>USArrest</code> data and apply <span class="math inline">\(K\)</span>-means for clustering.</p>
<p><strong>QUESTION</strong>:</p>
<ol style="list-style-type: decimal">
<li>Perform <span class="math inline">\(K\)</span>-means clustering with your chosen value of <span class="math inline">\(K\)</span>. (<span class="math inline">\(K\)</span> does not have to be optimal at this stage.)</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>Suppose we would like to group the data into 3 clusters. The corresponding <code>R</code> code is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="exercise-1-usarrests.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="exercise-1-usarrests.html#cb1-2" aria-hidden="true" tabindex="-1"></a>USArrests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(USArrests))</span>
<span id="cb1-3"><a href="exercise-1-usarrests.html#cb1-3" aria-hidden="true" tabindex="-1"></a>usarr.kcl <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(USArrests, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">100</span>)</span></code></pre></div>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Visualise the <span class="math inline">\(K\)</span>-means result and compare with HAC result obtained in Lab 8.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="exercise-1-usarrests.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(USArrests, <span class="at">col =</span> usarr.kcl<span class="sc">$</span>cluster)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-1.png" width="672" />
The number of observations in each cluster seems to be more balanced in the <span class="math inline">\(K\)</span>-means case compared with the HAC case. In addition, as <span class="math inline">\(K\)</span>-means assign observations to their nearest centre, there seems to be slightly less overlapping of clusters.</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Get the cluster means and append the cluster assignment to a new data frame.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Use <code>$cluster</code> to extract cluster assignment and <code>aggregate</code> function to calculate cluster means. The latter function has been studied in Lab 3 (Section 3.1).</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="exercise-1-usarrests.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get cluster means</span></span>
<span id="cb3-2"><a href="exercise-1-usarrests.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(USArrests,<span class="at">by=</span><span class="fu">list</span>(usarr.kcl<span class="sc">$</span>cluster),<span class="at">FUN=</span>mean)</span></code></pre></div>
<pre><code>##   Group.1     Murder    Assault   UrbanPop       Rape
## 1       1 -0.9615407 -1.1066010 -0.9301069 -0.9667633
## 2       2 -0.4469795 -0.3465138  0.4788049 -0.2571398
## 3       3  1.0049340  1.0138274  0.1975853  0.8469650</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="exercise-1-usarrests.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># append cluster assignment</span></span>
<span id="cb5-2"><a href="exercise-1-usarrests.html#cb5-2" aria-hidden="true" tabindex="-1"></a>USArrests_cl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(USArrests, usarr.kcl<span class="sc">$</span>cluster)</span></code></pre></div>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Plot the cluster results (saved in the new data frame) using the <code>clusplot</code> function within the <code>cluster</code> library.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="exercise-1-usarrests.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb6-2"><a href="exercise-1-usarrests.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">clusplot</span>(USArrests_cl, usarr.kcl<span class="sc">$</span>cluster, <span class="at">color=</span><span class="cn">TRUE</span>, <span class="at">shade=</span><span class="cn">TRUE</span>,</span>
<span id="cb6-3"><a href="exercise-1-usarrests.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="dv">2</span>, <span class="at">lines=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <code>clusplot</code> function uses principal component analysis (PCA) to draw the data. Thus, <code>Component 1</code> and <code>Component 2</code> refer to the first and second PCs, and <code>These two components explain xx% of the point variability</code> lists the cumulative proportion of variation explained by the first two PCs.</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li>(optional) Now perform <code>kmeans</code> with a different value of <span class="math inline">\(K\)</span>. By taking advantage of the <code>cluster.stats</code> function, compare the similarity between two cluster results.</li>
</ol>
<p><em>This refers to the supplementary material in Week 9 lecture note.</em></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>We have already said that choosing <span class="math inline">\(K\)</span> (i.e. the numbers of clusters) can sometimes look arbitrary. In that case we may be interested to compare the similarity between two cluster solutions using a variety of information criteria.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exercise-1-usarrests.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpc)</span>
<span id="cb7-2"><a href="exercise-1-usarrests.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-3"><a href="exercise-1-usarrests.html#cb7-3" aria-hidden="true" tabindex="-1"></a>usarr.kcl<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(USArrests, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">100</span>)</span>
<span id="cb7-4"><a href="exercise-1-usarrests.html#cb7-4" aria-hidden="true" tabindex="-1"></a>usarr.kcl<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(USArrests, <span class="at">centers=</span><span class="dv">5</span>, <span class="at">nstart=</span><span class="dv">100</span>)</span>
<span id="cb7-5"><a href="exercise-1-usarrests.html#cb7-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(USArrests)</span>
<span id="cb7-6"><a href="exercise-1-usarrests.html#cb7-6" aria-hidden="true" tabindex="-1"></a>cl.stats <span class="ot">&lt;-</span> <span class="fu">cluster.stats</span>(d, usarr.kcl<span class="fl">.3</span><span class="sc">$</span>cluster, usarr.kcl<span class="fl">.5</span><span class="sc">$</span>cluster)</span></code></pre></div>
<p>The corrected Rand index provides a measure for assessing the similarity between two partitions, adjusted for chance. Its range is <span class="math inline">\(-1\)</span> (no agreement) to <span class="math inline">\(1\)</span> (perfect agreement). Using the Rand index, agreement between the cluster solutions is</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="exercise-1-usarrests.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cl.stats<span class="sc">$</span>corrected.rand,<span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.52</code></pre>
</div>
<ol start="6" style="list-style-type: decimal">
<li>Use a silhouette plot to assess the results when using the <code>kmeans</code> function with different values for <span class="math inline">\(K\)</span>. Suggest which value of <span class="math inline">\(K\)</span> you might select to achieve the optimal clustering performance.</li>
</ol>
<p><em>Reminder: The silhouette width and plot were introduced in Week 8.</em></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="exercise-1-usarrests.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb10-2"><a href="exercise-1-usarrests.html#cb10-2" aria-hidden="true" tabindex="-1"></a>usarrests.kmeans<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(USArrests, <span class="at">centers=</span><span class="dv">2</span>, <span class="at">iter.max=</span><span class="dv">1000</span>)</span>
<span id="cb10-3"><a href="exercise-1-usarrests.html#cb10-3" aria-hidden="true" tabindex="-1"></a>usarrests.kmeans<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(USArrests, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">iter.max=</span><span class="dv">1000</span>)</span>
<span id="cb10-4"><a href="exercise-1-usarrests.html#cb10-4" aria-hidden="true" tabindex="-1"></a>si.k2 <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(usarrests.kmeans<span class="fl">.2</span><span class="sc">$</span>cluster, <span class="fu">dist</span>(USArrests))</span>
<span id="cb10-5"><a href="exercise-1-usarrests.html#cb10-5" aria-hidden="true" tabindex="-1"></a>si.k3 <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(usarrests.kmeans<span class="fl">.3</span><span class="sc">$</span>cluster, <span class="fu">dist</span>(USArrests))</span>
<span id="cb10-6"><a href="exercise-1-usarrests.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb10-7"><a href="exercise-1-usarrests.html#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(si.k2, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">main =</span> <span class="st">&quot;silhouette plot when k=2&quot;</span>)</span>
<span id="cb10-8"><a href="exercise-1-usarrests.html#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(si.k3, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">main =</span> <span class="st">&quot;silhouette plot when k=3&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-10-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>We can see that the 2 cluster solution has a higher average silhouette width than the 3 cluster solution. So if we were using this measure to decide, we would select the 2 cluster solution.</p>
<p>To test over a larger range of <span class="math inline">\(K\)</span>, we can use the function <code>fviz_nbclust</code> from the package <code>factoextra</code>. The argument <code>method</code> allows for different criteria in selecting the optimal number of clusters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exercise-1-usarrests.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb11-2"><a href="exercise-1-usarrests.html#cb11-2" aria-hidden="true" tabindex="-1"></a>ggplot_fviz_sil <span class="ot">&lt;-</span><span class="fu">fviz_nbclust</span>(USArrests, <span class="at">FUN=</span>kmeans, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>)</span>
<span id="cb11-3"><a href="exercise-1-usarrests.html#cb11-3" aria-hidden="true" tabindex="-1"></a>ggplot_fviz_sil <span class="co">#average siluhouette; the higher the better</span></span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<ol start="7" style="list-style-type: decimal">
<li>Use the within-cluster sum of squares as the measure to select the optimal value of <span class="math inline">\(K\)</span>.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Create a plot with the number of clusters on the horizontal axis and the total within cluster sum of squares value for the model with each number of clusters on the vertical axis. The number of <span class="math inline">\(K\)</span> is usually chosen to be where there is a bend in the lines joining the values.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exercise-1-usarrests.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-2"><a href="exercise-1-usarrests.html#cb12-2" aria-hidden="true" tabindex="-1"></a>K_max <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co">#maximum number of clusters</span></span>
<span id="cb12-3"><a href="exercise-1-usarrests.html#cb12-3" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, K_max)</span>
<span id="cb12-4"><a href="exercise-1-usarrests.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>K_max){</span>
<span id="cb12-5"><a href="exercise-1-usarrests.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  usarrests.kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(USArrests, <span class="at">centers=</span>i, <span class="at">nstart=</span><span class="dv">100</span>)</span>
<span id="cb12-6"><a href="exercise-1-usarrests.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  wss[i] <span class="ot">&lt;-</span> usarrests.kmeans<span class="sc">$</span>tot.withinss</span>
<span id="cb12-7"><a href="exercise-1-usarrests.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-8"><a href="exercise-1-usarrests.html#cb12-8" aria-hidden="true" tabindex="-1"></a>wss[<span class="dv">1</span>] <span class="ot">&lt;-</span> usarrests.kmeans<span class="sc">$</span>totss</span>
<span id="cb12-9"><a href="exercise-1-usarrests.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>K_max, wss, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="fl">1.5</span>, <span class="at">cex.main=</span><span class="fl">0.9</span>,</span>
<span id="cb12-10"><a href="exercise-1-usarrests.html#cb12-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Number of clusters&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Within-cluster sum of squares&quot;</span>,</span>
<span id="cb12-11"><a href="exercise-1-usarrests.html#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Assessing the Optimal Number of Clusters with the Elbow Method&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In this plot, it is slightly hard to find a clear cut-off point. We may choose two clusters or four clusters as it seems that the reduction in within-cluster sum of squares becomes slower.</p>
<p>Alternatively, we can again use the <code>fviz_nbclust</code> function by setting the method to <code>wss</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exercise-1-usarrests.html#cb13-1" aria-hidden="true" tabindex="-1"></a>ggplot_fviz_wss <span class="ot">&lt;-</span> <span class="fu">fviz_nbclust</span>(USArrests, <span class="at">FUN=</span>kmeans, <span class="at">nstart=</span><span class="dv">100</span>, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span>
<span id="cb13-2"><a href="exercise-1-usarrests.html#cb13-2" aria-hidden="true" tabindex="-1"></a>ggplot_fviz_wss <span class="co">#total within sum of square; same as the Elbow method, look at the knee</span></span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>

</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
